<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Practical Machine Learning Assignment</title>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}

pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>Practical Machine Learning Assignment</h1>

<h2>Introduction</h2>

<p>In this project, the goal was to use data from accelerometers on the belt, forearm, arm, and dumbell
of 6 participants to predict the manner in which they did the exercise. 
They were asked to perform barbell lifts correctly and incorrectly in 5 different ways.</p>

<h2>Data</h2>

<pre><code class="r">train &lt;- read.csv(&quot;pml-training.csv&quot;, na.strings = c(&quot;&quot;, &quot;NA&quot;), stringsAsFactors = F)
test &lt;- read.csv(&quot;pml-testing.csv&quot;, , na.strings = c(&quot;&quot;, &quot;NA&quot;), stringsAsFactors = F)
train &lt;- within(train, {classe &lt;- factor(classe)})
</code></pre>

<p>The data was obtained from the <a href="http://groupware.les.inf.puc-rio.br/har">Human Activity Recognition</a> 
reasearch by Groupware Technologies.
The training dataset containted 19622 observations with 160 variables.
The test dataset had 20 observations and the same number of variables.
The variable of interest was <code>classe</code>, which classified the manner the participants performed
the dumbbell bicep curl. It took on 5 values: A, B, C, D and E.</p>

<h2>Variable Cleaning</h2>

<p>On reviewing the datasets, it was observed that many of the measurements 
had missing values for the majority of the obsersvations. 
A check revealed that measurements had the same number of missing values,
suggesting that the missing values originated from the same large number of observations.
Hence, it would not be appropriate to remove those observations.
Rather such variables would be removed since they would not be useful for prediction. </p>

<pre><code class="r">sumNA &lt;- apply(sapply(train, is.na), 2, sum)
table(sumNA)
</code></pre>

<pre><code>## sumNA
##     0 19216 
##    60   100
</code></pre>

<p>The first 7 variables contained information such as name of participants, time, etc.
which would not be useful and were also removed.</p>

<pre><code class="r">names(train)[1:7]
</code></pre>

<pre><code>## [1] &quot;X&quot;                    &quot;user_name&quot;            &quot;raw_timestamp_part_1&quot;
## [4] &quot;raw_timestamp_part_2&quot; &quot;cvtd_timestamp&quot;       &quot;new_window&quot;          
## [7] &quot;num_window&quot;
</code></pre>

<pre><code class="r">train_sub &lt;- subset(train, select = (sumNA == 0))[, -(1:7)]
test_sub &lt;- subset(test, select = (sumNA == 0))[, -(1:7)]
</code></pre>

<p>The resulting datasets had 53 variables including the variable <code>classe</code>. 
The structure of the training dataset was shown below. The test dataset was similar.</p>

<pre><code class="r">str(train_sub)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    19622 obs. of  53 variables:
##  $ roll_belt           : num  1.41 1.41 1.42 1.48 1.48 1.45 1.42 1.42 1.43 1.45 ...
##  $ pitch_belt          : num  8.07 8.07 8.07 8.05 8.07 8.06 8.09 8.13 8.16 8.17 ...
##  $ yaw_belt            : num  -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 ...
##  $ total_accel_belt    : int  3 3 3 3 3 3 3 3 3 3 ...
##  $ gyros_belt_x        : num  0 0.02 0 0.02 0.02 0.02 0.02 0.02 0.02 0.03 ...
##  $ gyros_belt_y        : num  0 0 0 0 0.02 0 0 0 0 0 ...
##  $ gyros_belt_z        : num  -0.02 -0.02 -0.02 -0.03 -0.02 -0.02 -0.02 -0.02 -0.02 0 ...
##  $ accel_belt_x        : int  -21 -22 -20 -22 -21 -21 -22 -22 -20 -21 ...
##  $ accel_belt_y        : int  4 4 5 3 2 4 3 4 2 4 ...
##  $ accel_belt_z        : int  22 22 23 21 24 21 21 21 24 22 ...
##  $ magnet_belt_x       : int  -3 -7 -2 -6 -6 0 -4 -2 1 -3 ...
##  $ magnet_belt_y       : int  599 608 600 604 600 603 599 603 602 609 ...
##  $ magnet_belt_z       : int  -313 -311 -305 -310 -302 -312 -311 -313 -312 -308 ...
##  $ roll_arm            : num  -128 -128 -128 -128 -128 -128 -128 -128 -128 -128 ...
##  $ pitch_arm           : num  22.5 22.5 22.5 22.1 22.1 22 21.9 21.8 21.7 21.6 ...
##  $ yaw_arm             : num  -161 -161 -161 -161 -161 -161 -161 -161 -161 -161 ...
##  $ total_accel_arm     : int  34 34 34 34 34 34 34 34 34 34 ...
##  $ gyros_arm_x         : num  0 0.02 0.02 0.02 0 0.02 0 0.02 0.02 0.02 ...
##  $ gyros_arm_y         : num  0 -0.02 -0.02 -0.03 -0.03 -0.03 -0.03 -0.02 -0.03 -0.03 ...
##  $ gyros_arm_z         : num  -0.02 -0.02 -0.02 0.02 0 0 0 0 -0.02 -0.02 ...
##  $ accel_arm_x         : int  -288 -290 -289 -289 -289 -289 -289 -289 -288 -288 ...
##  $ accel_arm_y         : int  109 110 110 111 111 111 111 111 109 110 ...
##  $ accel_arm_z         : int  -123 -125 -126 -123 -123 -122 -125 -124 -122 -124 ...
##  $ magnet_arm_x        : int  -368 -369 -368 -372 -374 -369 -373 -372 -369 -376 ...
##  $ magnet_arm_y        : int  337 337 344 344 337 342 336 338 341 334 ...
##  $ magnet_arm_z        : int  516 513 513 512 506 513 509 510 518 516 ...
##  $ roll_dumbbell       : num  13.1 13.1 12.9 13.4 13.4 ...
##  $ pitch_dumbbell      : num  -70.5 -70.6 -70.3 -70.4 -70.4 ...
##  $ yaw_dumbbell        : num  -84.9 -84.7 -85.1 -84.9 -84.9 ...
##  $ total_accel_dumbbell: int  37 37 37 37 37 37 37 37 37 37 ...
##  $ gyros_dumbbell_x    : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ gyros_dumbbell_y    : num  -0.02 -0.02 -0.02 -0.02 -0.02 -0.02 -0.02 -0.02 -0.02 -0.02 ...
##  $ gyros_dumbbell_z    : num  0 0 0 -0.02 0 0 0 0 0 0 ...
##  $ accel_dumbbell_x    : int  -234 -233 -232 -232 -233 -234 -232 -234 -232 -235 ...
##  $ accel_dumbbell_y    : int  47 47 46 48 48 48 47 46 47 48 ...
##  $ accel_dumbbell_z    : int  -271 -269 -270 -269 -270 -269 -270 -272 -269 -270 ...
##  $ magnet_dumbbell_x   : int  -559 -555 -561 -552 -554 -558 -551 -555 -549 -558 ...
##  $ magnet_dumbbell_y   : int  293 296 298 303 292 294 295 300 292 291 ...
##  $ magnet_dumbbell_z   : num  -65 -64 -63 -60 -68 -66 -70 -74 -65 -69 ...
##  $ roll_forearm        : num  28.4 28.3 28.3 28.1 28 27.9 27.9 27.8 27.7 27.7 ...
##  $ pitch_forearm       : num  -63.9 -63.9 -63.9 -63.9 -63.9 -63.9 -63.9 -63.8 -63.8 -63.8 ...
##  $ yaw_forearm         : num  -153 -153 -152 -152 -152 -152 -152 -152 -152 -152 ...
##  $ total_accel_forearm : int  36 36 36 36 36 36 36 36 36 36 ...
##  $ gyros_forearm_x     : num  0.03 0.02 0.03 0.02 0.02 0.02 0.02 0.02 0.03 0.02 ...
##  $ gyros_forearm_y     : num  0 0 -0.02 -0.02 0 -0.02 0 -0.02 0 0 ...
##  $ gyros_forearm_z     : num  -0.02 -0.02 0 0 -0.02 -0.03 -0.02 0 -0.02 -0.02 ...
##  $ accel_forearm_x     : int  192 192 196 189 189 193 195 193 193 190 ...
##  $ accel_forearm_y     : int  203 203 204 206 206 203 205 205 204 205 ...
##  $ accel_forearm_z     : int  -215 -216 -213 -214 -214 -215 -215 -213 -214 -215 ...
##  $ magnet_forearm_x    : int  -17 -18 -18 -16 -17 -9 -18 -9 -16 -22 ...
##  $ magnet_forearm_y    : num  654 661 658 658 655 660 659 660 653 656 ...
##  $ magnet_forearm_z    : num  476 473 469 469 473 478 470 474 476 473 ...
##  $ classe              : Factor w/ 5 levels &quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<h2>Model Building</h2>

<p>I chose to build the model using random forest due to its good performance. 
The tuning parameter for random forest was <code>mtry</code>,
which could take the values of integers up to the number of predictors in the dataset, 
in this case, it was 52.
Due to the large dataset, I faced the issue of a very time consuming model building process.
As a result, I broke down the model building to a few steps
to select the best tuning parameter and finalise the model.</p>

<p>The <code>doParallel</code> package was used to enable parallel computing, 
which would be extremely useful in speeding up the computation
since the <code>caret</code> package allowed the use of parallel computing by default.</p>

<pre><code class="r">library(doParallel)
cl &lt;- makeCluster(detectCores())
registerDoParallel(cl)
</code></pre>

<h3>Initial Model Selection</h3>

<p>The first step was to go through the whole range of possible values of <code>mtry</code> over a coarse grid.
The range of values of <code>mtry</code> that produced models with performance above a threshold would 
then be used at the next stage over a finer grid. The initial grid was as followed.</p>

<pre><code class="r">print(grid &lt;- seq(1, 52, by = 2))
</code></pre>

<pre><code>##  [1]  1  3  5  7  9 11 13 15 17 19 21 23 25 27 29 31 33 35 37 39 41 43 45
## [24] 47 49 51
</code></pre>

<p>As this would be an exploratoy stage, I used 2-fold cross validation to estimate the accuracy 
of the models, on which their performance was evaluated.
In addition, I set the number of trees to grow, <code>ntree</code>, to a smaller number of 200
to further reduce computation times.</p>

<pre><code class="r">library(caret)
set.seed(1)
seeds &lt;- c(replicate(2, sample.int(1000, length(grid)), simplify = F), sample.int(1000, 1))
modelRF1 &lt;- train(classe ~ ., data = train_sub, method = &quot;rf&quot;, ntree = 200,
                 trControl = trainControl(method = &quot;cv&quot;, number = 2, seeds = seeds),
                 tuneGrid = data.frame(mtry = grid))
modelRF1$times$everything
plot(modelRF1$finalModel, log = &quot;y&quot;)
</code></pre>

<pre><code>##    user  system elapsed 
##   33.69    0.20  551.38
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAq1BMVEX9/v0AAAAAAEYAAHMAAP8ARkYARpoAdJoAdL0AzQAA//9GAABGAEZGAHNGRgBGRkZGRnNGRppGdHNGdL1Gm5pGm95zAABzAEZzAHNzRgBzdEZzdHNzm5pzvr1zvv2aRgCaRkaaRnOavpqa372a396a3/29dAC9m0a9vnO935q9/r29/t69/v3em0be35re/r3e/t7e/v39vnP935r9/r39/t79/v3/AAD/AP9KoFdTAAAAOXRSTlP///////////////////////////////////////////////////////////////////////8A//+pNr4gAAAACXBIWXMAAAsSAAALEgHS3X78AAAaj0lEQVR4nO2dCWOjSHqGF7fGseRsks6s3ZPLntkde3c21k7askH//5eFoqCoCyigLvjepw9JgApJD3VSxx9KQJI/pP4AIA0QTxSIJwrEEwXiiQLxRIF4okA8USCeKBBPFIgnCsQTBeKJAvFEgXiiQDxRIJ4oEE8UiCcKxBMF4okC8USBeKJAPFEgnnN+SP0JIrNb8R+Pt9+lF1/ePh4Lxpe38vO5eVY81Xsu93fN/qJgh1/ui5u/1MdaQvvyxt7GLo8zP3b0ZGG+k0/Iia+lSeJfi+KOe2+evDYXgzU0Jv7mX+ow2bshPjXvxT8915H4zKNv/dDESebmfxoXZ+6Xi2c+uMHWTH3cvzLf78XtX//0+OV/2QVx+zs/4m9N4lDvKoqbl078f9abPh7//b4LevBkKX8TNzYvvqP+sV8LHnHbGF274FseBsX//PLOxF/ub//6wBV24tugeFpw+70V/+f7p/qU/30vgh46WeKfxYHNi//yVmfMTx+PNy+X+yZqsif1L3+uXVzum6SZS++SeuHqjgfAHl7b2MuS+jY7f2DpQJN+d1dNLf4vjw/l+ctv9yzo0ZOl/E3c2Lz4uy4Z5pG3dvD0zvPt2+9tenDzIol/Ki3iu4y7F99oZeLZ24T4l9fb/3u+/cc9C3r0ZCl/Ezd2IZ6V1xzEN/KbJL0304qvq3P1GyXxTWbOojHPRjrx5y9/f3y4QHxyZPEDqS9D5PEsWzDF1/8NiD/XFwoLrhN/uf8v9t9gUt+dLM2vMYcdiR8sb/GyGfdxLqTCXRuA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" title="plot of chunk rf1" alt="plot of chunk rf1" style="display: block; margin: auto;" /></p>

<p>The above plot showed that the error rate was stable enough for <code>ntree</code> set to 200.</p>

<pre><code class="r">plot(modelRF1)
gridrng &lt;- with(modelRF1$results, range(mtry[Accuracy &gt; 0.99]))
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAjVBMVEUAAAAAAEgAAHQASHQASJwAdL8AgP9IAABIAEhIAHRISHRISJxIdL9InN90AAB0AEh0AHR0SAB0SEh0SJx0dHR0dL90v/+cSACcSEicSHScdACcnHScnL+c37+c3/+/dAC/dEi/dHS/35y//7+////fnEjfv3Tf35zf///m5ub/v3T/35z//7///9////+Rj9naAAAACXBIWXMAAAsSAAALEgHS3X78AAAVVElEQVR4nO2dC3vavBmGaZe4X9eRZmtH2m1f2CFs1ID//8+bDoZgsPzqaL+SnudqCcZw2+hGljC2vOqQKrNaegWQZQLxlQbiKw3EVxqIrzQQX2kgvtJAfKWB+EoD8ZUG4isNxFcaiK80EF9pIL7SQHylgfhKA/GVBuIrDcRXGoivNBBfaSC+0kB8pYH4SgPxlQbiKw3EV5oU4mMxC+XwWB2In53DY3UgfnYOj9WB+Nk5PFYH4mfn8FgdiJ+dw2N1IqzFCuGZ5OJvH/gVziyZM9fqQDwzDsRTKZQD8VQK5UA8lUI5EE+lUA7EUymUA/FUCuVAPJVCORBPpVBOBuK3qw+v8u/pZbVaX90+7CcRzAqaG4e/+PZh3yrHu0fxIdjo21bdTiKYFTQ3Dn/xu3V3fH7Td7rtWt+qGb34/seAXwjHTP9UMyl+051+SvFy8/59rW/FpKz0UwhmNYwbJ6Ma30/0t9uhd4hfBjNHGy+q+PHrq749vWxungbxi2CS9+qP3/bizmrT6dutbDfWkwhmBc2Nk4F4u0D8IhiIz40D8VQK5UA8lUI5EE+lUA7EU9GcpmmicMID8QQi6jtr+v+hnAiBeAIRV7yo8BDvw8lP/Hnj3qjIv+RTJwPxznOtElu82rjL0G28XTsA8c5zrRJdfNO7vnCMbpvOph2AeOe5VokqvpduK96qAwDxznOtEkF8X8WHf644k+bJQLzzXKuEiz+36kaOyW5j9VUP4p3nWiWC+BHrQ45BL8RPhL34q1bdyBnX25hnBaxPag7Ey/TWR5vqa87Y/MY4x399ZuBULX7K9zhn5JmNcY7z+lgF4gkE/c4srN9y7p/cGOc4r49dIJ5A2Ii3+R425Nw9H+Knw1S8c9t8+/zGOMd9fewC8QTCuo0ncsNpTJMQPxqe4m3Ak+Ib0wyS4x2IJxCJxA9e1JhmWHB8A/EEAuLnwGQp3u6QmjuOqVmH+LEUJP79dcaOnh3HLxBPINKLN3+1s+P4BeIJBPnOLA+eHOEYds9D/EhqED9NhHjnuVaZU7zp8EqIv08V4ieREO881yrO4m3PjxjlGHb2QvxdyhIvD6tFjbfiFCbe9LveBBTinedaxVW89ZlwLm08xN+lLPHGH3Qh/jaFiffAQrzzXKtA/CKY7MTbn+wO8UGcWsSbwRDvPNcqEL8IJjfxDsOaQHwQpxrxRjTEO8+1CsQvgoF4kg3xznOt4iTewTvEh3FqEj++OxfinedahY140y93EO881you4l28Q3wYpybx4wdpQLzzXKuwET82cpYXxxCIJxCLiTcsAOKd51rFQbyTd78Smh49KygQTyAWFT+yDIh3nmsVZuLvFwLxznOtYi/ezbt3Cd0uBuKd51oF4hfBQDy5HIh3nmsVfuJvFgTxznOtYi3e0XtICQ0WBfHOc60C8YtgIJ5cFsQ7z7WKrXhX72EldLU0iHeeaxWe4q8WB/HOc63CVPz78iDeea5V7MR7XBs4VPzwalZsLk5cl3i7gcppjkPU1UkvHOOJ9bOtT2QMxJvS9BenvUoYEOIJBBvxdzU+TD3EEwgmbXw31saHqId4AjG+Ru4lnqaErC6AlXJ9IJ5KshIyXuLQkeMXiKeSsITsLkNNc3wC8VRSivfoa0I8hchAPNr4WsUvuD4QTyVxCWFTHxiIXwSTi3iPHSepS2jmPYmRMRDvzYH4sGQrfr6jflNgIN6fA/FByVf8POfyJcJAfAAH4kOSsfj0AzWkw0B8CAfiA5Kz+LTj7iXFQHwQB+LHsl19eJV/Ty+r1bq/vTxoRuQkPunYukkxCcW3D3vxT9zZPQrfG317edCMgPg5MAnF79bd8flN3+m268utflC+WOeXTRqrZy0QtisWmt6Oj/hNd/opHcuN/Pe1vr08aEZkVePTXSolMWaOGt9PqNvBg+OIvMSnuhxaaswcbXz72B2/vva3hbXxED8S1YE/ftuLO6tNd7ktqlff2a9aPeLtAvFugXgqc5WQ7bpBPIGA+DkwEB+BY7dyEE8gxtbI5yRViA/iQLwFx+rEGognEPmJv4yaEsixCsRTmXNTb3MOJcQTiBzF2wyVAfEEIj/xdufLQzyByFC8ClXpIZ5A5CqeWkuIJxD5ip+u9BBPIDIWP6ke4glE1uL7ETEjcEyBeCoLiTfuzoF4ApG9eEOVh3gCkb/48Z33hYpv1cG4G/cVKE68adTTIsW3q0f55/Tirr488ZcMPwElipdHVPb515vpubYLKEd8Nxj3tkTxISlb/NV+/ELF6zb+o2t9r0D8ea9OmeKPTx79uvEFFCb+clWjQsU/u9d1wwJKE9+V3cZv154rUIN4tf5lij8+pWzjva4Ew0m8fAdlivdPHeLFW4B4AlGm+K4pVLwc92A1PAHaLrWID71Q5TnMxJ9eZOdu52Ee4t3CTLz+Oufzpa4a8b/imGcmHjXeghPFPDPxaONtODHMcxPvnZrExzAP8VQ4io9gnpX44/N/sOfOisPmMvSo8fNy7M6oJjERgq9zs3K8rkp7j4mQOJv6p37kU3ydIzh2Z1STmAjJ4vf4csR7XY54BBMetPGzc4qq8d0OvXpbTlHi9SjFu0f3FahPfJh5buKf3/Q/5xWAeF9MWGL9SPPjVfw7fIZ4G06IeWbiO+G8VVcbcg3Ee2OCkkOv3q+cGIsPMQ/xVCA+iOO25y7N17nyxAeYZyW+60+oSPR1DuJNmIDk8CNNgeL9zTMTn/SYO4g3YvwT9Zg7jy19reK9zXMT7x2ID8J4B+KX4niaZyU+8TF3ED+B8Q1q/GIc3m8L4iHePBd77rw4rH97Qo2HeOe5VqlYPOuhfTgccwfx0xiv5HDMXbHifQ625iY+5TF3xYr3OaGKmfikx9yVK97jhCpm4pMecwfx0xivoFe/JCf/Nt4/tHjmO7XDOHmLPz59ePVdgcrF576pP714HYUxtgCI98E4J96mvvXZfQPx5reX9CpmUdv441OSPXeVim/G5/ET76Ud4o3vz/Bdj5l40cZ7aYd4s/iGv3j06oM4E+ZdMG7B9/jlOeNv0LAfn6H4nddlaSDe8A6z6dxBvDdn7B02hhkQTyUj8SNvsTE8zlG8XyC+M4sfmcFN/O5hv0t0GfEaxTemGdzEH7++in9pDsSoQPzde8xH/PObqPMQ78tpTJN3b56Z+G63+vDaYlPvzWkMU+zFewfiVRrTxO27h3gqeYm/fpfGD8GMq4NePcRPzkWvPpjT3N0ZneQmfqRXv13p3+zk8Djr8+T5QfMCbteI+5ghsTh5ih/p1bcP+1aNgiVPrNpu9OTlQfMCahVv3Fk3fICb+Pvs1v24d3If/nZ9+LJvHzt9279Y5xeRhnpCKWmubu8fnzu9HR/xm+70U4qXm/rv665Vlypqby9YhBp/ieEHOd41/v7aspcaryfEBl90AfTt5ALqFm/8hXbu1fEf2fLSnIttu+jx68/B4NMwvoB6xZsOuuEsfmwsW9WBP37bizui1yc3CefbyQXULN5wKt31o8zEJxzLth7xjck8Y/EJrx9flXjz4Xdzr87y++prEj9xxO3cq+PUxvsE4t9jPF2er/jTD98zKiDeInzFH9MNYgzx3XUhMBPvH4i3CcTbh4WwaJxLKTATv32Um3uP4zAg3i5Mxes9N8enFMOdQbwMT/HHr7pPf/iCPXepOOdi4CW+/xafZEhTiFc5f8dnJf70olv3FvvqU3Euu3NZie8Ov8lt/eFTiqNsIV6GqXi9AyfJ4Ee+3pkIi8WRP9VzFO8fiLcLyzb++NfLI/9yrfUQbx2GNb7VA5qeXtzPpYF4+zRxMCqxNvWt+pEmQecO4t/DUbx3IN4hDcTT4SQsGqeBeDKshMXiQDwdVsKicRqIp8JLWDSOd3ncJNqeO88LVEC8Y5iJV9/nvIawhnhHTCTzMTf19+dHWQTiXTFxzEcTf/ikTpVz/kUe4p0xUcxHa+N9Tp8aXQDEUxhO4v0D8e6YGObj7avfdDuf3h3Ee2AimI+1qVeHW6YY7gziRzB8xOuj7lIccwfxY5hw87E29d7HXkG8F8bjOtSjHGPQuWPG6Wu8YbgcV445EM+Mc97UGwbPcOSYYz+yZZrTpP3fHTNhhYoXvfr2UQ1e6hqI98JwaeOPz2/6n/MKQLwnhof4049X8S/B93iIN2F4iJf7blo1OrlrIN4Tw0S8dyDeF8Ojc5dquDOIN2JYiE823BnEGzEsxCcb7gzizZgg82jjM+NAPBVmwgoVj039XJxrTIj5qDV+h+/xyTksxWOXbXoOS/EtNvXJOczE9218/IERIH4KE2AevfrMOBBPhZmwUsWnOq4e4icx6Ypn6ePqIX4Ss7j4ZMfVQ/wkZnHxqY6rT9iIZcq5wSQ7CHnhzh3EExiIvwszYaWKT9Srh3gCs7T4VL16iKcwqYbzX7hXD/EUZmHx6NXPxeEm3jsQH4jxLCKIz4zDUfwu/qFXEE9ilhafZmRLiKcxfmUUR7wa3XDrc2lZiA/GLCheH2sH8XNwWIlXX+Y2ED8Hh5d4mS3a+Dk4IxivQorZqz+9oFefnMNRvFcgPhhzW0hW4+NAfGacMUxzN0WXG8RnxrEQ39gMhQbxmXFI8Y3dGHgQnxlnFPNeTGqs0/zb+JQnh2XKmRR/Ng7xEcKMMyH+qqLnvqmHeDuM6s9dFxbEh4cZZ7xzd9usQ3x4mHEM4m+Liiw5iM+MY/o6B/FjnJAw4xjb+NuHfDhXgXhmHFsMxIeGGccaQ5QdxGfGgXgqzIRVJP58SI68uvj6PLlbrYYXroH4VJjpwksnvn3Y63Pp5CWKths92T7eHpQJ8akwS4nfrfujb+VAp9v14Yu0vvv+XuNXOr8m0kzNRIgElV5vx0f8pjv9lOLlpv77umtXov5vH9WMKQRqfCzMZOnNUOP1hNjgHz6/SentYKhjiE+GWUj8pY0XW/jj11f9OWhR42fETBVf6l798ZvYvstBbuUGf6N69cOxzSE+HWYh8XaB+ISYifKD+Mw4EE+FmbBFxE8UIGvxSa+2kykH4qkwEwbxFALiY2KMRQjxmXEgngozYQuJN5YhxGfGgXgqzIRBPIWA+LgYQyFCfGYciKfCTNhi4g2lCPGZcTzEj54uD/GZcTw29aMDZEB8ZhyIp8JMGMRTCIiPjEEbXwTHBwPxBXAgngozYRBPISA+OgbiC+B4YdCrz59Tg/gg79yEQTyFgPj4GIjPn+OHuS9KiM+MA/FUmAmDeAoB8QkwEJ89xxNzV5YQnxkH4qkwEwbxFALiU2AgPneOL+a2MCE+Mw7EU2EmDOIpBMQnwUB85hxvzE1pQnxmHIinwkwYxFMIiE+Dgfi8Of6YYXFCfGYciKfCTBjEUwiIT4TJRnyYd27Clhc/LFCIz4wD8VSYCYN4CgHxqTAQnzMnBHNdohCfGQfiqTATBvEUAuKTYSA+Y04Q5qpIIT4zDsRTYSYM4ikExKfDQHy+nDDMe5lCfGYciKfCTBjEUwiIT4iB+Gw5gZhLoUJ8ZhyIp8JMGMRTCIhPiYH4XDmhmHOp8hUf6J2bMIinEBCfFAPxmXIgngozYWzE95cmgvjMOMG9+v5iZBCfGQfiqTATxkZ810B8jpwIbTxv8ePXR3QIM2FcxMvIouUq3nBFVIcwE8ZJvCxeiM+MEwnT8BWPgRFSYsjCRRvPjBNtdYjiXXIolLAUyom3OtPmIZ4ZJ+LqTG5TIZ4ZJ+rqNOYGFeKZcSKLN/byIJ4ZJ65485dmiGfGiSweNT4XTtzVQRufDWeu1YF4ZpwMxG9XH17l39PLarV+n9ytpxHMCpobh7/49mEv/ok7u0dhfXOebFcQzwCTULyo2cfnN32n264PX/at+AQcvvz3LH6l8wvhmN6Oj/hNd/opxctN/fe1qOqiwouPQosazwAzR43XE2KDf/j8tpOfooF5iF8EM0cbL7bwx6+vl88BajwHTPJe/fHbXtxZbdQGfyMfhngOGHyPz40D8VQK5UA8lUI5EE+lUA7EUymUA/FUCuVAPJVCORBPpVAOxFMplAPxVArlQDyVQjkQT6VQDsRTKZRTjniEZ1KLT8YslMNjdSB+dg6P1YH42Tk8VgfiZ+fwWB2In53DY3UgfnYOj9VJIR7JIBBfaSC+0kB8pYH4SgPxlQbiK0188edxM8KiTs8MRsnT/R72EVZJnTwY463t1jEwYnUEIogTXfzlFNswyurjWwRUOxjKI4gjxwUIf2tyNJFwzOmHFB7GiS5+cFK9b07/kCMyREF1u00UjiCEc9RoIuGY418+rR4DOfHFn4fRCIsSHwMlKmsMzlZU1WCOHk0kfHXaj7Jwwjg8a3wvPgJq+xhrlXbrYI4eTSTO6rSBHKZtvBIfoTF82URZJTkUxG4d4621Mdp4tTqBXReuvXq1EQtGbVUVi9ONfozy1tpYvfpQDr7HVxqIrzQQX2kgvtJAfKWB+EoD8ZUG4isNxFcaiK80EF9pIL7S5Ct+uzn9eD18kj/DfBz7cVL/MneTw+f3px6frl95Ped+WsP00oaDtuuZl2ffYtgmW/HC+vH5TZfzbuzXSUr88Wlz/Uor8fKx49fbn8SulwTxaSOPohR5+J8qZ1nasjZuusOXv6nDIkVt/sOfN/KPqNOnH38X9bSVdVU8cyuftb+yqJ8kJ/U9+efD7/Lu+7SE9S+R9fuPf76Z2b/6+mXqSa1hc7R8MhWvD6lad5caLw2KicMndaBDt5WXTtqoPw/708uj+FyoK+qIf/JQCLm1Pr30tV08SV9up78nK3CrPlJ6+gzrxR9+Ew3MphvOFHMGLxNLlU+SR8jIJzFMtuKFdVl3VavbG+w3/eK/LHAhQv4Rnwh5UKr8L+7Ked/2/9Qb61YdpKwqvXrl+71OSe6ne1h3buM3euswmKk/U/3L9FLPT2KaTMVfb+pbfRzKVm5Ve/FKwlZtgIXxofjTj9+/XboEovrKPp74AEhj/T3ZEHRX0xrWvTfg/Yb9aqZc5vll/VL15uFTlOOREiRT8X3fTqvYfXxTXbW+0Ika3+2+q355qzbB201/wGL/qu6s9336qsZfix/MNNR4tZwIRyAmSK7iRf2SVazvbukmWra+WvxNGz8UL54mCapXL7fFfZN8aZyl5MPnf1+mb9r489/BzL6Nv36ZfJJ8AsRHje7bnWun6NLtVufetdrUvgx69QPx54PR5cZabodlb/z1vPm+PHB6Ud1zOd3DbsQPZl5e3b+s/5qg25/lSmkiuYoPyOFPS68Bh9Qnfse0tzVz6hOPqEB8pYH4SgPxlQbiKw3EVxqIrzQQX2kgvtJAfKX5Px8iIMTpGsf0AAAAAElFTkSuQmCC" title="plot of chunk results1" alt="plot of chunk results1" style="display: block; margin: auto;" /></p>

<p>From the above plot, it could be observed the way the accuracy of the models varied 
as the tuning parameter was changed. The models with <code>mtry</code> in the range of (3, 23)
had accuracies above 99% and would be used for the next stage of model building.
The model performance deteriorated quickly beyond that range.
The grid of <code>mtry</code> for the next stage was shown below.</p>

<pre><code class="r">print(grid &lt;- gridrng[1]:gridrng[2])
</code></pre>

<pre><code>##  [1]  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
</code></pre>

<h3>Final Model Selection</h3>

<p>The final model selection was done using the finer grid of <code>mtry</code> selected in the previous step.
Since this step was used only to select the best value of the tuning parameter,
<code>ntree</code> was also set to 200 to reduce computation times.
However, I increased the number of folds of cross validation to 5 for better estimates of accuracy.</p>

<pre><code class="r">set.seed(2)
seeds &lt;- c(replicate(5, sample.int(1000, length(grid)), simplify = F), sample.int(1000, 1))
modelRF2 &lt;- train(classe ~ ., data = train_sub, method = &quot;rf&quot;, ntree = 200,
                  trControl = trainControl(method = &quot;cv&quot;, number = 5, seeds = seeds),
                  tuneGrid = data.frame(mtry = grid))
modelRF2$times$everything
plot(modelRF2)
</code></pre>

<pre><code>##    user  system elapsed 
##   34.50    0.45 1671.59
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk rf2" alt="plot of chunk rf2" style="display: block; margin: auto;" /></p>

<pre><code class="r">print(best &lt;- modelRF2$bestTune$mtry)
</code></pre>

<pre><code>## [1] 12
</code></pre>

<p>The final selected <code>mtry</code> value was 12.</p>

<h3>Final Model</h3>

<p>With the tuning parameter selected, it would be time to build the final model.
A 10-fold cross validation was used so that the out-of-sample error rate could be estimated.
<code>ntree</code> was left as the default value of 500.</p>

<pre><code class="r">set.seed(3)
seeds &lt;- as.list(sample.int(1000, 11))
modelRF3 &lt;- train(classe ~ ., data = train_sub, method = &quot;rf&quot;,
                  trControl = trainControl(method = &quot;cv&quot;, seeds = seeds),
                  tuneGrid = data.frame(mtry = best))
modelRF3$finalModel
modelRF3$times$everything
print(results &lt;- modelRF3$results)
</code></pre>

<pre><code>## 
## Call:
##  randomForest(x = x, y = y, mtry = param$mtry) 
##                Type of random forest: classification
##                      Number of trees: 500
## No. of variables tried at each split: 12
## 
##         OOB estimate of  error rate: 0.27%
## Confusion matrix:
##      A    B    C    D    E class.error
## A 5577    2    0    0    1   0.0005376
## B   10 3783    4    0    0   0.0036871
## C    0    8 3412    2    0   0.0029223
## D    0    0   18 3196    2   0.0062189
## E    0    0    2    3 3602   0.0013862
</code></pre>

<pre><code>##    user  system elapsed 
##   84.22    0.69  582.58
</code></pre>

<pre><code>##   mtry Accuracy  Kappa AccuracySD  KappaSD
## 1   12   0.9968 0.9959   0.001922 0.002432
</code></pre>

<p>From the accuracy, the error rate was estimated to be <strong>0.3211%</strong>.
This would be an extremely good prediction performance.
The final model was then used to make prediction on the test dataset.
As an exercise, the models produced in the initial 2 steps were also used 
to make prediction to compare their outcomes.</p>

<pre><code class="r">predRF1 &lt;- predict(modelRF1, test_sub)
predRF2 &lt;- predict(modelRF2, test_sub)
predRF3 &lt;- predict(modelRF3, test_sub)
data.frame(predRF1, predRF2, predRF3)
</code></pre>

<pre><code>##    predRF1 predRF2 predRF3
## 1        B       B       B
## 2        A       A       A
## 3        B       B       B
## 4        A       A       A
## 5        A       A       A
## 6        E       E       E
## 7        D       D       D
## 8        B       B       B
## 9        A       A       A
## 10       A       A       A
## 11       B       B       B
## 12       C       C       C
## 13       B       B       B
## 14       A       A       A
## 15       E       E       E
## 16       E       E       E
## 17       A       A       A
## 18       B       B       B
## 19       B       B       B
## 20       B       B       B
</code></pre>

<p>It turned out all 3 models produced the same predictions.
The prediction outcomes were then saved into separate files as instructed.</p>

<pre><code class="r">pml_write_files = function(x){
    n = length(x)
    for(i in 1:n){
        filename = paste0(&quot;problem_id_&quot;,i,&quot;.txt&quot;)
        write.table(x[i],file=filename,quote=FALSE,row.names=FALSE,col.names=FALSE)
    }
}
if(!file.exists(&quot;predictions&quot;)) dir.create(&quot;predictions&quot;)
setwd(&quot;predictions&quot;)
pml_write_files(predRF3)
setwd(&quot;..&quot;)
stopCluster(cl)
</code></pre>

</body>

</html>
